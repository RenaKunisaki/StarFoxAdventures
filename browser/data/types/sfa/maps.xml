<?xml version="1.0"?>
<?xml-model href="../types.xsd"?>
<types namespace="maps">
    <enum name="MapDirIdx16" type="s16">
        <item name="animtest" />
        <item name="animtest_01" />
        <item name="animtest_02" />
        <item name="arwing" />
        <item name="dragrock" />
        <item name="animtest_05" />
        <item name="dfptop" />
        <item name="volcano" />
        <item name="animtest_08" />
        <item name="mazecave" />
        <item name="dragrockbot" />
        <item name="dfalls" />
        <item name="swaphol" />
        <item name="shipbattle" />
        <item name="nwastes" />
        <item name="warlock" />
        <item name="shop" />
        <item name="animtest_11" />
        <item name="crfort" />
        <item name="swapholbot" />
        <item name="wallcity" />
        <item name="lightfoot" />
        <item name="cloudtreasure" />
        <item name="animtest_17" />
        <item name="clouddungeon" />
        <item name="mmpass" />
        <item name="darkicemines" />
        <item name="animtest_1B" />
        <item name="desert" />
        <item name="animtest_1D" />
        <item name="icemountain" />
        <item name="animtest_1F" />
        <item name="animtest_20" />
        <item name="animtest_21" />
        <item name="darkicemines2" />
        <item name="bossgaldon" />
        <item name="animtest_24" />
        <item name="insidegal" />
        <item name="magiccave" />
        <item name="dfshrine" />
        <item name="mmshrine" />
        <item name="ecshrine" />
        <item name="gpshrine" />
        <item name="dbshrine" />
        <item name="nwshrine" />
        <item name="worldmap" />
        <item name="animtest_2E" />
        <item name="capeclaw" />
        <item name="dbay" />
        <item name="animtest_31" />
        <item name="cloudrace" />
        <item name="bossdrakor" />
        <item name="animtest_34" />
        <item name="bosstrex" />
        <item name="linkb" />
        <item name="cloudjoin" />
        <item name="arwingtoplanet" />
        <item name="arwingdarkice" />
        <item name="arwingcloud" />
        <item name="arwingcity" />
        <item name="arwingdragon" />
        <item name="gamefront" />
        <item name="linklevel" />
        <item name="greatfox" />
        <item name="linka" />
        <item name="linkc" />
        <item name="linkd" />
        <item name="linke" />
        <item name="linkf" />
        <item name="linkg" />
        <item name="linkh" />
        <item name="linkj" />
        <item name="linki" />
        <item name="NUM_MAPS" value="0x49" />
        <item name="NO_MAP" value="-1" />
    </enum>

    <struct name="RomListEntry">
        <description>Common header of romlist entries</description>
        <field name="objDef" type="ObjDefEnum" />
        <field name="length" type="u8">
            <description>Number of 4-byte words in this entry</description>
        </field>
        <field name="acts0" type="u8" />
        <field name="loadFlags" type="u8" />
        <field name="acts1" type="u8" />
        <field name="bound" type="u8" />
        <field name="cullDist" type="u8" />
        <field name="position" type="vec3f" />
        <field name="id" type="ObjUniqueId">
            <description>Globally unique ID of this object</description>
        </field>
        <!-- following this is object-specific params -->
    </struct>

    <struct name="MapsBinEntry0">
        <description>Entry in MAPS.bin referenced by MapsTabEntry.info</description>
        <field name="sizeX" type="s16" />
        <field name="sizeZ" type="s16" />
        <field name="originX" type="s16" />
        <field name="originZ" type="s16" />
        <field name="unk08" type="u32" />
        <field name="unk0C" type="u32" count="4">
            <note>rect related? 4 of these, 4 of those...</note>
        </field>
        <field name="nBlocks" type="s16" />
        <field name="unk1E" type="u16">
            <description>possibly flags</description>
        </field>
    </struct>

    <struct name="MapsTabEntry">
        <description>Entry in MAPS.tab</description>
        <field name="info" type="u32">
            <description>offset of MapsBinEntry0</description>
        </field>
        <field name="blocks" type="u32">
            <description>offset of u32[] (block data)</description>
        </field>
        <field name="rects" type="u32" count="4">
            <description>offsets of some rect data</description>
        </field>
        <field name="romList" type="u32">
            <description>offset of a FACEFEED header</description>
            <note>In old versions this points to the actual list.
                In the final version this points to a FACEFEED header
                with no data following (the data is in a separate file);
                its size tells how much memory to allocate.
                The final will still load a list from here if there is
                no external file. (TODO check for maps that have old
                lists here.)
            </note>
        </field>
    </struct>

    <struct name="MapInfoEntry">
        <description>Entry in MAPINFO.bin</description>
        <field name="name" type="char" count="28">
            <description>Map name displayed in debug menus</description>
        </field>
        <field name="type" type="u8">
            <description>Map type</description>
        </field>
        <field name="unk1D" type="u8">
            <description>Always 6</description>
        </field>
        <field name="objType" type="ObjDefEnum">
            <description>If not zero, use this object type as the player. Not used in final version.</description>
        </field>
    </struct>

    <struct name="MapGridItem">
        <description>Entry in globalma.bin</description>
        <field name="x" type="s16">
            <description>Global X coord</description>
        </field>
        <field name="z" type="s16">
            <description>Global Z coord</description>
        </field>
        <field name="layer" type="s16">
            <description>Layer ID (-2 to 2)</description>
        </field>
        <field name="link" type="s16" count="2">
            <description>Linked map IDs</description>
        </field>
    </struct>

    <struct name="WarpTabEntry">
        <field name="pos" type="vec3f" />
        <field name="layer" type="s16" />
        <field name="xRot" type="s16" />
    </struct>
</types>
